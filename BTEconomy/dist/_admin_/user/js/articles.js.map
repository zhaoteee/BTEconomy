{"version":3,"sources":["articles.js"],"names":["$","getArticles","num","jsonpCallbackhs","msg","rendArticles","wList","initPagination","ajax","type","url","dataType","jsonp","jsonpCallback","success","data","str","i","len","length","id","name","userr","heat","date","split","state","html","options","currentPage","page","totalPages","zong","numberOfPages","onPageClicked","event","originalEvent","bootstrapPaginator","document","cookie","some","x","window","location","href","getName","on","e","jsonpCallbackhd","jsonpCallbackhuw","sta","t","addClass","removeClass","srcElement","target","nodeName","is","attr","confirm","jsonpCallbackhcn","searchText","val","trim"],"mappings":"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","file":"articles.js","sourcesContent":["$(function () {\n  getS();\n  function getS() {\n    var ck = document.cookie.split(';');\n    var res = ck.some(function(x) {\n      if (x) {\n       return x.split('=')[0] =='name';\n      }\n    })\n    if (!res) {\n      window.location.href = './login.html';\n    }\n  }\n  getArticles(1);\n  getName();\n  $('.articles table tbody').on('click', function(e) {\n    var t = e.srcElement ? e.srcElement : e.target;\n    // 删除\n    if (t.nodeName === 'SPAN' && $(t).is('.deleteArticle')) {\n      var id = $(t).attr('data-id');\n      var cfm = confirm('确认删除吗？');\n      if (cfm) {\n        $.ajax({\n          type: 'get',\n          url: 'http://www.lopkj.cn:8111/lampconsole/deleteWordsByPeople.action?id='+id,\n          dataType:\"jsonp\",\n          jsonp: \"callback\",\n          jsonpCallback: 'jsonpCallbackhd',\n          success: function (msg) {\n            jsonpCallbackhd(msg);\n          }\n        })\n        function jsonpCallbackhd(msg) {\n           if (msg.state === 'success') {\n              getArticles(1);\n            }\n        }\n      }\n    }\n    // 置顶切换\n    if (t.nodeName === 'SPAN' && $(t).is('.downArticle')) {\n      var id = $(t).attr('data-id');\n      var sta;\n      if ($(t).is('.label-default')) {\n        sta = 1;\n      } else if ($(t).is('.label-info')) {\n        sta = 2;\n      }\n      $.ajax({\n        type: 'get',\n        url: 'http://www.lopkj.cn:8111/lampconsole/updateWordsStateById.action?state='+sta+'&id='+id,\n        dataType:\"jsonp\",\n        jsonp: \"callback\",\n        jsonpCallback: 'jsonpCallbackhuw',\n        success: function (msg) {\n          jsonpCallbackhuw(msg);\n        }\n      })\n      function  jsonpCallbackhuw(msg) {\n          if (msg.state === 'success') {\n              if (sta === 1) {\n                $(t).addClass('label-info');\n                $(t).removeClass('label-default');\n              } else {\n                $(t).removeClass('label-info');\n                $(t).addClass('label-default');\n              }\n          }\n      }\n    }\n  })\n  $('#search').on('click', function () {\n    var searchText = $('#search-input').val().trim();\n    if (!searchText) {\n      getArticles(1);\n      return;\n    }\n    $.ajax({\n      type: 'get',\n      url: 'http://www.lopkj.cn:8111/lampconsole/countByLikeName.action?name='+searchText,\n      dataType:\"jsonp\",\n      jsonp: \"callback\",\n      jsonpCallback: 'jsonpCallbackhcn',\n      success: function (msg) {\n        jsonpCallbackhcn(msg);\n      }\n    })\n    function jsonpCallbackhcn(msg) {\n      var data = msg.wList;\n      rendArticles(data);\n    }\n  })\n  \n  \n  // 获取文章列表数据并渲染\n  function getArticles(num) {\n    $.ajax({\n      type: 'get',\n      url: 'http://www.lopkj.cn:8111/lampconsole/selectAllWords.action?page='+num,\n      dataType:\"jsonp\",\n      jsonp: \"callback\",\n      jsonpCallback: 'jsonpCallbackhs',\n      success: function (msg) {\n        jsonpCallbackhs(msg);\n      }\n    })\n    function jsonpCallbackhs(msg) {\n      var data = msg.wList;\n      rendArticles(data);\n      initPagination(msg);\n    }\n  }\n  // 渲染文章列表\n  function rendArticles(data) {\n    var str = '';\n    for (var i = 0, len = data.length; i < len; i++) {\n      str += '<tr><td>'+data[i].id+'</td><td><a class=\"toDetail\" target=\"_blank\"  href=../../../articleDetail.html?id='+data[i].id+'>'+data[i].name+'</a></td>'+\n            '<td>'+data[i].userr+'</td><td>'+data[i].heat+'</td><td>'+data[i].date.split('.')[0]+'</td>'+\n            '<td style=\"\" class=\"\"><a href=\"./newArticle.html?id='+data[i].id+'\" class=\"table_operate\">'+\n            '<span data-id='+data[i].id+'  class=\"editArticle label label-success mr-5 trans\">编辑</span>'+\n            '</a><a class=\"table_operate\">'+\n            '<span data-id='+data[i].id+' class=\"deleteArticle label label-danger mr-5\">删除</span>'+\n            '</a><a class=\"table_operate\">'+\n            '<span data-id='+data[i].id+' class=\"downArticle label mr-5 trans '+(data[i].state === 2 ? 'label-default':'label-info')+'\">置顶</span>'+\n            '</a></td></tr>'\n        }\n    $('.articles table tbody').html(str);\n  }\n  // 获取登陆账号名称\n  function getName() {\n    var str = '';\n    var name = document.cookie.split(';')\n    for (var i = 0, len = name.length; i < len; i++) {\n      if(name[i]) {\n        var n1 = name[i].split('=')[0];\n        if (n1 === 'name') {\n          str = name[i].split('=')[1];\n        }\n      }\n    }\n    $('.x-user').html('账号：'+str);\n  }\n  function initPagination(data) {\n    var options = {\n      currentPage: data.page,\n      totalPages: data.zong,\n      numberOfPages:5,\n      \"onPageClicked\": function(event, originalEvent, type, page) {\n        getArticles(page);\n      }\n    }\n    $('#pg').bootstrapPaginator(options);\n  }\n})"]}
{"version":3,"sources":["tags.js"],"names":["$","initTags","pageNum","ajax","type","url","success","msg","obj","JSON","parse","rendTag","bList","initPagination","data","Array","isArray","str","i","len","length","name","id","find","html","options","currentPage","page","totalPages","zong","numberOfPages","onPageClicked","event","originalEvent","bootstrapPaginator","document","cookie","split","some","x","window","location","href","on","val","trim","alert","state","modal","e","t","srcElement","target","nodeName","is","text","parent","prev","attr","unbind","confirm"],"mappings":"AAAAA,EAAE,WAoFA,SAASC,EAASC,GACfF,EAAEG,MACCC,KAAM,MACNC,IAAK,+DAA+DH,EACpEI,QAAS,SAAUC,GACjB,IAAIC,EAAMC,KAAKC,MAAMH,GAErBI,EADWH,EAAII,OAEfC,EAAeL,MAKvB,SAASG,EAAQG,GACf,GAAoB,iBAATA,GAAsBC,MAAMC,QAAQF,GAA/C,CAIA,IAAK,IADDG,EAAM,GACDC,EAAI,EAAGC,EAAML,EAAKM,OAAQF,EAAIC,EAAKD,IAC1CD,GAAQ,uCAAuCC,EAAE,GAAG,8BACnBJ,EAAKI,GAAGG,KAAK,qHAE2BP,EAAKI,GAAGI,GAAG,mGAEhBR,EAAKI,GAAGI,GAAG,2BAEjFtB,EAAE,gBAAgBuB,KAAK,SAASC,KAAKP,IAEvC,SAASJ,EAAeC,GACtB,IAAIW,GACFC,YAAaZ,EAAKa,KAClBC,WAAYd,EAAKe,KACjBC,cAAc,EACdC,cAAiB,SAASC,EAAOC,EAAe7B,EAAMuB,GACpD1B,EAAS0B,KAGb3B,EAAE,OAAOkC,mBAAmBT,GAtHnBU,SAASC,OAAOC,MAAM,KAClBC,KAAK,SAASC,GACzB,GAAIA,EACH,MAAyB,QAAlBA,EAAEF,MAAM,KAAK,OAIrBG,OAAOC,SAASC,KAAO,gBAG3BzC,EAAS,GAETD,EAAE,cAAc2C,GAAG,QAAS,WAC1B,IAAI1B,EAAMjB,EAAE,WAAWuB,KAAK,oBAAoBqB,MAAMC,OACtD,IAAK5B,EAEH,OADA6B,MAAM,WACC,EAEP9C,EAAEG,MACAC,KAAM,OACNC,IAAK,wDACLS,KAAM,QAAQG,EACdX,QAAS,SAAUC,GAEC,YADRE,KAAKC,MAAMH,GACbwC,OACN9C,EAAS,GACTD,EAAE,WAAWgD,MAAM,SAEnBF,MAAM,cAOhB9C,EAAE,gBAAgB2C,GAAG,QAAS,SAAUM,GACtC,IAAIC,EAAID,EAAEE,WAAaF,EAAEE,WAAaF,EAAEG,OACxC,GAAmB,SAAfF,EAAEG,UAAuBrD,EAAEkD,GAAGI,GAAG,aAAc,CACjD,IAAIC,EAAOvD,EAAEkD,GAAGM,SAASA,SAASC,OAAOF,OACrCjC,EAAOtB,EAAEkD,GAAGQ,KAAK,WACrB1D,EAAE,YAAYuB,KAAK,oBAAoBqB,IAAIW,GAAMG,KAAK,UAAUpC,GAChEtB,EAAE,YAAYgD,MAAM,QACpBhD,EAAE,YAAYuB,KAAK,eAAeoC,OAAO,SACzC3D,EAAE,YAAYuB,KAAK,eAAeoB,GAAG,QAAS,WAC5C,IAAI7B,GACFQ,GAAMA,EACND,KAAQrB,EAAE,YAAYuB,KAAK,oBAAoBqB,OAEjD5C,EAAEG,MACAC,KAAM,OACNC,IAAK,yDACLS,KAAMA,EACNR,QAAS,SAAUC,GAEC,YADRE,KAAKC,MAAMH,GACbwC,OACN9C,EAAS,GACTD,EAAE,YAAYgD,MAAM,SAEpBF,MAAM,cAMhB,GAAmB,SAAfI,EAAEG,UAAuBrD,EAAEkD,GAAGI,GAAG,eAAgB,CACnD,IAAIpC,EAAIlB,EAAEkD,GAAGQ,KAAK,WACRE,QAAQ,UAEhB5D,EAAEG,MACAC,KAAM,MACNC,IAAK,6DAA6Da,EAClEZ,QAAS,SAAUC,GACjBN,EAAS","file":"tags.js","sourcesContent":["$(function () {\n  getS();\n  function getS() {\n    var ck = document.cookie.split(';');\n    var res = ck.some(function(x) {\n      if (x) {\n       return x.split('=')[0] =='name';\n      }\n    })\n    if (!res) {\n      window.location.href = './login.html';\n    }\n  }\n  initTags(1);\n  // 添加标签\n  $('.js-addTag').on('click', function () {\n    var str = $('#addcl1').find('input[type=text]').val().trim();\n    if (!str) {\n      alert('请输入标签名');\n      return false;\n    } else {\n      $.ajax({\n        type: 'post',\n        url: 'http://www.lopkj.cn:8111/lampconsole/creatBall.action',\n        data: 'name='+str,\n        success: function (msg) {\n          var obj = JSON.parse(msg)\n          if (obj.state === \"success\") {\n            initTags(1);\n            $('#addcl1').modal('hide')\n          } else {\n            alert('添加失败！');\n          }        \n        }\n      })\n    }\n  })\n  // 编辑与删除标签\n  $('.tagsWrapper').on('click', function (e) {\n    var t = e.srcElement ? e.srcElement : e.target;\n    if (t.nodeName === 'SPAN' && $(t).is('.edit-tag')) {\n      var text = $(t).parent().parent().prev().text();\n      var id   = $(t).attr('data-di');\n      $('#editTag').find('input[type=text]').val(text).attr('data-di',id);\n      $('#editTag').modal('show');\n      $('#editTag').find('.js-editTag').unbind('click');\n      $('#editTag').find('.js-editTag').on('click', function () {\n        var data = {\n          \"id\": id,\n          \"name\": $('#editTag').find('input[type=text]').val()\n        }\n        $.ajax({\n          type: 'POST',\n          url: 'http://www.lopkj.cn:8111/lampconsole/updateBall.action',\n          data: data,\n          success: function (msg) {\n            var obj = JSON.parse(msg);\n            if (obj.state === 'success') {\n              initTags(1);            \n              $('#editTag').modal('hide');\n            } else {\n              alert('更新失败！');\n            }\n          }\n        })\n      })\n    }\n    if (t.nodeName === 'SPAN' && $(t).is('.delete-tag')) {\n      var i = $(t).attr('data-di');\n      var con = confirm('确认删除？');\n      if (con) {\n        $.ajax({\n          type: 'get',\n          url: 'http://www.lopkj.cn:8111/lampconsole/deleteBall.action?id='+i,\n          success: function (msg) {\n            initTags(1);\n          }\n        })\n      }\n    }\n  })\n\n  //函数\n  // 进入页面获取tags数据并更新列表\n  function initTags(pageNum) {\n     $.ajax({\n        type: 'get',\n        url: 'http://www.lopkj.cn:8111/lampconsole/selectBall.action?page='+pageNum,\n        success: function (msg) {\n          var obj = JSON.parse(msg);\n          var data = obj.bList;\n          rendTag(data);\n          initPagination(obj);\n        }\n    })\n  }\n  //渲染标签列表\n  function rendTag(data) {\n    if (typeof data !== 'object' || !Array.isArray(data)) {\n      return;\n    }\n    var str = '';\n    for (var i = 0, len = data.length; i < len; i++) {\n      str +=  '<tr class=\"\"><td style=\"\" class=\"\">'+(i+1)+'</td>'+\n              '<td style=\"\" class=\"\">'+data[i].name+'</td>'+\n              '<td style=\"\" class=\"\"><a class=\"table_operate\">'+\n              '<span class=\"edit-tag label label-success mr-5 trans\" data-di='+data[i].id+'>编辑</span>'+\n              '</a><a class=\"table_operate\">'+\n              '<span class=\"delete-tag label label-danger mr-5\" data-di='+data[i].id+'>删除</span></a></td></tr>';\n    }\n    $('.tagsWrapper').find('tbody').html(str)\n  }\n  function initPagination(data) {\n    var options = {\n      currentPage: data.page,\n      totalPages: data.zong,\n      numberOfPages:5,\n      \"onPageClicked\": function(event, originalEvent, type, page) {\n        initTags(page);\n      }\n    }\n    $('#pg').bootstrapPaginator(options);\n  }\n})"]}
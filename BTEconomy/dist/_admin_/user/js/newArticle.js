$(function(){function t(t,a){$.ajax({type:"POST",url:t,data:a,success:function(t){var a=JSON.parse(t);"success"===a.state?(alert("上传成功！"),window.location.href="./articles.html"):"文章已存在"===a.state&&alert("文章已存在")}})}function a(t){$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/selectWordsById.action?id="+t,success:function(t){e(JSON.parse(t).word)}})}function e(t){var a="";l.val(t.name),o.val(t.fname),c.val(t.userr),s.val(t.source),r.val(t.pic);for(var e=0,n=t.bList.length;e<n;e++)a+="<span data-id="+t.bList[e].id+">"+t.bList[e].name+"</span>",d.find("input[data-id="+t.bList[e].id+"]").prop("checked","checked");u.html(a),i.txt.html(t.word)}$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/selectAllBall.action",success:function(t){for(var a=JSON.parse(t).bList,e="",n=0,i=a.length;n<i;n++)e+="<label>"+a[n].name+" <input data-id="+a[n].id+' type="checkbox" value='+a[n].name+" /></label>";d.html(e)}});var n=0;!function(){var t=window.location.href.split("?")[1];t&&(t=t.split("&")[0]),t&&"id"===t.split("=")[0]&&a(n=t.split("=")[1])}(),document.cookie.split(";").some(function(t){if(t)return"name"==t.split("=")[0]})||(window.location.href="./login.html");var i=new(0,window.wangEditor)("#editor");i.customConfig.uploadFileName="fileToUpload",i.customConfig.uploadImgServer="http://www.lopkj.cn:8111/lampconsole/UploadServlet.action",i.customConfig.uploadImgMaxSize=3145728,i.create();var l=$(".articleTitle"),o=$(".articleSubtitle"),r=$(".articleSmallimg"),c=$(".articleAuthor"),s=$(".articleSource"),p=$(".addTags"),d=$(".tagsWrapper"),u=$(".tagsList");p.on("click",function(){d.toggleClass("height70")}),d.on("click",function(t){var a=t.srcElement?t.srcElement:t.target,e="",n=$(a);if("INPUT"===a.nodeName){n.attr("data-id");d.find("input:checked").each(function(){e+="<span data-id="+$(this).attr("data-id")+">"+$(this).val()+"</span>"}),u.html(e)}}),$(".imgload-input").change(function(){function t(){a.value=""}var a=this,e=$(this),n=a.files[0];if(n){if(n.size>5242880)return alert("请上传小于5M的图片！"),void t();if(!function(t){return{has:function(a){var e=a.split("."),n=e[e.length-1].toLowerCase();return t.indexOf(n)>-1}}}(["jpg","png","gif","bmp","jpeg"]).has(n.name))return alert("请上传正确的图片！"),void t();var i=new FormData;i.append("fileToUpload",n),$.ajax({url:"http://www.lopkj.cn:8111/lampconsole/UploadServlet.action",type:"POST",data:i,processData:!1,contentType:!1,dataType:"JSON"}).done(function(a){a.data?e.parents("div.input-group-addon").prev().val(a.data[0]):alert("上传失败，请重新再试"),t()})}}),document.getElementById("publishArticle").onclick=function(){var a="";u.find("span").each(function(t){a+=$(this).attr("data-id")+","});var e={name:l.val().trim(),fname:o.val().trim(),pic:r.val(),user:c.val().trim(),source:s.val().trim(),word:i.txt.html(),number:a.substr(0,a.length-1),id:n};e.name?e.fname?e.pic?e.user?e.source?e.number?t(n?"http://www.lopkj.cn:8111/lampconsole/updateWordsById.action":"http://www.lopkj.cn:8111/lampconsole/creatWords.action",e):alert("请选择文章标签！"):alert("请输入文章来源！"):alert("请输入文章作者名称！"):alert("请输入文章缩略图！"):alert("请输入文章副标题！"):alert("请输入文章标题！")}});
//# sourceMappingURL=newArticle.js.map

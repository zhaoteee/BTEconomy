$(function(){function a(){function a(a){var e=a.bList;l=e,t(e)}$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/selectProject.action",dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallbackhuspr",success:function(t){a(t)}})}function t(a){for(var t="",e=0,n=a.length;e<n;e++)t+="<tr data-id="+a[e].id+'><td class="text-center">'+(e+1)+"</td><td>"+a[e].name+'</td><td><a class="table_operate"><span class="editColumn label label-success mr-5 trans">编辑</span></a><a class="table_operate"><span class="deleteColumn label label-danger mr-5">删除</span></a><a class="table_operate"><span state='+a[e].state+' class="changeColumn label mr-5 '+(1===parseInt(a[e].state)?"label-info":"label-default")+'">'+(1===parseInt(a[e].state)?"显示(是)":"显示(否)")+"</span></a></td></tr>";$(".columns tbody").html(t)}function e(){function a(a){for(var t=a.bList,e="",n=0,l=t.length;n<l;n++)e+="<label>"+t[n].name+" <input data-id="+t[n].id+' type="checkbox" value='+t[n].name+" /></label>";o.html(e)}$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/selectAllBall.action",dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallbackhusab",success:function(t){a(t)}})}function n(t,e){function n(t){"栏目已经存在"===t.state&&alert("栏目已经存在"),"success"===t.state&&(a(),$("#addColumn").modal("hide"))}var l=$("#addColumn input[type=text]").val().trim(),s="";if(c.find("span").each(function(a){s+=$(this).attr("data-id")+","}),l)if(s){var o={};o=e?{name:l,number:s.substr(0,s.length-1),id:e}:{name:l,number:s.substr(0,s.length-1)},$.ajax({type:"POST",url:t,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallbackhusgg",data:o,success:function(a){n(a)}})}else alert("请选择关联标签！");else alert("请填写栏目名")}var l=[];e(),a(),document.cookie.split(";").some(function(a){if(a)return"name"==a.split("=")[0]})||(window.location.href="./login.html");var s=$(".addTags"),o=$(".tagsWrapper"),c=$(".tagsList");s.on("click",function(){o.toggleClass("height70")}),o.on("click",function(a){var t=a.srcElement?a.srcElement:a.target,e="",n=$(t);if("INPUT"===t.nodeName){n.attr("data-id");o.find("input:checked").each(function(){e+="<span data-id="+$(this).attr("data-id")+">"+$(this).val()+"</span>"}),c.html(e)}}),$("#addColumn .js-addColumn").on("click",function(){n("http://www.lopkj.cn:8111/lampconsole/creatProject.action",null)}),$(".columns tbody").on("click",function(t){function e(t){"success"===t.state&&a()}function s(a){"success"===a.state&&$(d).removeClass("label-default").addClass("label-info").attr("state","1").text("显示(是)")}function s(a){"success"===a.state&&$(d).addClass("label-default").removeClass("label-info").attr("state","2").text("显示(否)")}var d=t.srcElement?t.srcElement:t.target;if("SPAN"===d.nodeName&&$(d).is(".deleteColumn")){i=$(d).parents("tr").attr("data-id");confirm("确认删除吗？")&&$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/deleteProject.action?id="+i,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallbackhdp",success:function(a){e(a)}})}if("SPAN"===d.nodeName&&$(d).is(".changeColumn")){var i=$(d).parents("tr").attr("data-id"),p=$(d).attr("state");2===parseInt(p)&&$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/updateStateById.action?state=1&id="+i,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallbackhus",success:function(a){s(a)}}),1===parseInt(p)&&$.ajax({type:"get",url:"http://www.lopkj.cn:8111/lampconsole/updateStateById.action?state=2&id="+i,dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallbackhus1",success:function(a){s(a)}})}if("SPAN"===d.nodeName&&$(d).is(".editColumn")){var u=[],r="",i=$(d).parents("tr").attr("data-id"),m=$(d).parent().parent().prev().text();$("#addColumn .js-addColumn").addClass("hide"),$("#addColumn .js-editColumn").removeClass("hide"),$("#addColumn input[type=text]").val(m);for(var f=0,b=l.length;f<b;f++)if(l[f].id==i){u=l[f].BList;break}for(var h=0,j=u.length;h<j;h++)r+="<span data-id="+u[h].id+">"+u[h].name+"</span>",o.find("input[data-id="+u[h].id+"]").prop("checked","checked");c.html(r),$("#addColumn").modal("show"),$("#addColumn .js-editColumn").unbind("click"),$("#addColumn .js-editColumn").on("click",function(){n("http://www.lopkj.cn:8111/lampconsole/updateProject.action",i)})}}),$("#addColumn").on("hidden.bs.modal",function(){$('#addColumn input[type="text"]').val(""),c.html(""),o.find('input[type="checkbox"]').removeAttr("checked"),$("#addColumn .js-addColumn").removeClass("hide"),$("#addColumn .js-editColumn").addClass("hide")})});
//# sourceMappingURL=column.js.map
